## Decision Log (ADRs)

The following decisions were drafted as part of the design of this solution.
It’s important to point out that some of these need to be discussed with the client (Family Farmacy) as a decision maker.

| Decision | Alternative(s) | Reasons for Decision | Audience | Decision maker |
|--------------------------------------------------|-------------------------------------------|-------------------------------------|-------------|--------------|
| There is no dedicated Clinic Actor engaging with our Solution | Having a dedicated Actor e.g. Clinic representative. | Clinics have their own online presence and solutions, they will be no benefit at this point in having an online presence maintained by the Clinic on the Family Farmacy site. | Architecture Team + Client Team | FamilyFarmacy |
| The FamilyFarmacy is envisioned to run in the AWS Cloud. | Build a custom-made solution, deployed in another cloud. This would raise the following problems:</br>- operational (2 clouds to manage)</br>- technical (ensure the integration between 2 clouds) | The decision was made considering the following:</br>- FarmacyFood is an AWS solution and FarmacyFamily is an extension of FarmacyFood</br>- AWS cloud comes already with a set of services and solutions that are beneficial for FarmacyFamily (search engine, SSO solution, persistence layer etc) | Architecture Team + Client Team | FamilyFarmacy Team |
| Events in FoodFarmacy (or on the Forum, Blog, Classes etc) are sent to a messaging queue, to be later processed by a scalable pool of FamilyFarmacy Event Data Consumers (such that Customer profile is updated) | Events in FoodFarmacy (or on the Forum, Blog, Classes etc) could directly result in an API call that would persist such event data in the respective Databases. This would raise the following problems:</br>- in case of periods with high number of such Events (from multiple sources) there would be a lot of load on the databases (which may not be desired)</br>- in cases of any changes required for processing a certain event, this may require changes on both event source (make another API call?) and on the FamilyFarmacy processor side | Using messaging queue(s), the communication between the Event sources and FamilyFarmacy is asynchronous, and the events can be processed at a safe rate, without impacting the databases.</br>Adding or removing processors for events will not have an impact on the Event source side. | Architecture Team | Architecture Team |
| The Campaign Management System needs extra Workers to execute the Campaigns. | Alternatively, the solution could rely on the Campaign execution capabilities of the Campaign Management solution. In this case it maybe harder to scale (if 1000x of emails need to be sent, or 1000x of messages on various media). | The decision was made to ensure:</br>- better scaling so that campaigns for large customer segments could be executed faster</br>Disadvantages:</br>- the campaign execution workers would be tightly coupled with the Campaign Management System | Architecture Team | Architecture Team |
| Zoom | Teams, GoogleMeet | Zoom was selected as it is a web conferencing software that’s simple to use, secure and doesn’t require additional extra collaboration tools (or a Google email account) for hosting webinars and events (or for participating to them). | Architecture Team | FamilyFarmacy Team |
| moodle | Canvas, Open EdX, Brightspace | Moodle was selected as it’s a well known open source (under the GPL license), free class management system with a rich set of extensions, available on-premise (and also installable in AWS). | Architecture Team | FamilyFarmacy Team |
| joomla | Drupal, Wordpress | Joomla was selected as it’s free, simple customizable CMS solution, available on-premise (and also installable in AWS), with support for Blogs and Forums. | Architecture Team | FamilyFarmacy Team |
| Customer Profile data (incl. medical records) are not saved into the Campaign Management Solution persistence layer, but rather are kept in the FamilyFarmacy platform database. | The Customer profile data (incl. medical records) are stored directly in the Campaign Management system’s database. | The decision was made to keep Customer Profile data separated from the Campaign System because:</br>- it deals with sensitive data (medical records) that should remain local to the solution in AWS and not exported to yet another Cloud solution</br>- the Customer Profile data is custom-made and should be enhanceable in time and should not be dependent on the Campaign Management solution’s data model</br>- keeping this data isolated from the Campaign Mgmt system should facilitate for HIPAA compliance | Architecture Team | Architecture Team |


## Open Points
The following points are still open as the team requires either more details, or more time or a larger audience to close these.

| Topic | Details and Alternatives |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------|
| How to optimize the usage of the **Content Management System** solution, as there are different parts of the Family Farmacy landscape where such features are needed? | The following areas require content management:</br>- Forum and blog solution</br>- Class Mgmt solution (classes and events)</br>- Family Farmacy platform</br>yet the current CMS solution (joomla) is envisioned to be used only for the Forum and Blog solution. It’s unclear how dynamic should the other web apps. |
| The **persistence layer** was currently represented in the Logical Diagram as separated databases (although at least some of them could be part of the same database). | Further analysis would be required here regarding:</br>- expected traffic for each application (and database)</br>- volume of data to be handled in each application (and database)</br>- type of traffic required for both |
| What type of **databases** should the Family Farmacy solutions use? | The data managed by the FamilyFarmacy solutions fall into the following categories</br>- **Content data** - this data is handled by the joomla Content Management system - which requires MySQL or MariaDB as database alternatives.</br>- **Class data** - this data is managed by the moodle Class Management system -which requires MySQL or MariaDB as database alternatives</br>- **FamilyFarmacy customers and dieticians transactional and operational data** (customer account, dieticial account etc).  This data requires a persistence layer which offers data integrity & security together with fast read/write access to individual records. The current assumption would be that this database could be a Relational database (e.g. AWS Aurora)</br>- **Data used for analytics and segmentation** (the customer profile information, including medical records). This data requires a persistence layer which is optimized for fast operations on potentially large amount of data (to ensure fast segmentation). The current assumption would be that this database could be an in-memory database (e.g. AWS ElastiCache), but alternatives could include AWS Redshift or DynamoDB with DAX Accelarator (free for 1y)</br>From the Architecture team’s point of view, further analysis is required to have a clear selection at least for the database used for the analytics and segmentation. |
| **Licensing cost** | The solution was designed to rely where possible on free (open-source) solutions, deployed in AWS, making use also of existing AWS services. The exact licensing cost of the solution was not yet computed as some decisions are still open. |
| Could the entire **FamilyFarmacy platform site be built on top of the Joomla CMS**, making use also of its search engine? | This would simplify a bit the architectural landscape - but more investigations would be needed here for a clear decision |
